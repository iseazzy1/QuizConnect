<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="questoes9passe.css">
  <title>Quiz Connect - Sele√ß√£o de Mat√©rias</title>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="logo">Quiz Connect</div>
    <nav>
      <a href="inicial.html">In√≠cio</a>
      <a href="cadastro.html">Cadastro</a>
    </nav>
    <div class="header-right">
      <img src="sesi-logo.png" alt="SESI Logo" class="sesi-logo">
      
      <!-- Container de acessibilidade -->
      <div class="accessibility-container">
        <!-- Bot√£o de Acessibilidade -->
        <div style="position: relative;">
          <button class="accessibility-btn" id="accessibilityBtn" title="Ativar/Desativar Leitura de Tela">
            üîä
          </button>
          
          <!-- Controles de Acessibilidade -->
          <div class="accessibility-controls" id="accessibilityControls">
            <div class="control-group">
              <label>Velocidade:</label>
              <input type="range" class="control-slider" id="speedControl" min="0.5" max="2" step="0.1" value="1">
              <span id="speedValue">1x</span>
            </div>
            
            <div class="control-group">
              <label>Volume:</label>
              <input type="range" class="control-slider" id="volumeControl" min="0" max="1" step="0.1" value="1">
              <span id="volumeValue">100%</span>
            </div>
            
            <div class="control-group">
              <button class="control-btn" id="pauseBtn">‚è∏Ô∏è Pausar</button>
              <button class="control-btn" id="stopBtn">‚èπÔ∏è Parar</button>
              <button class="control-btn" id="skipBtn">‚è≠Ô∏è Pular</button>
            </div>
          </div>
        </div>
      </div>
      
      <button class="login-btn" title="Login">
        <img src="logo.png" alt="√çcone de Login">
      </button>
    </div>
  </header>

  <!-- Main Content -->
  <div class="container">
    <h1>Escolha sua √Årea do Conhecimento para realizar a Prova</h1>
    
    <div class="cards-container">
      <!-- Matem√°tica - √çcone melhorado -->
      <div class="card matematica" onclick="selecionarMateria('matematica', 'Matem√°tica')">
        <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="8" y1="12" x2="16" y2="12"></line>
          <line x1="12" y1="8" x2="12" y2="16"></line>
        </svg>
        Matem√°tica
      </div>
      
      <!-- Ci√™ncias da Natureza - √çcone melhorado -->
      <div class="card natureza" onclick="selecionarMateria('ciencias', 'Natureza')">
        <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path>
          <path d="M14.31 8l5.74 9.94M9.69 8h11.48M7.38 12l5.74-9.94M7.38 12l5.74 9.94M9.69 16L3.95 6.06M14.31 16H2.83"></path>
        </svg>
        Natureza
      </div>
      
      <!-- Ci√™ncias Humanas - √çcone melhorado -->
      <div class="card humanas" onclick="selecionarMateria('historia', 'Humanas')">
        <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path>
          <line x1="9" y1="7" x2="16" y2="7"></line>
          <line x1="9" y1="11" x2="16" y2="11"></line>
          <line x1="9" y1="15" x2="14" y2="15"></line>
        </svg>
        Humanas
      </div>
      
      <!-- Linguagens - √çcone melhorado -->
      <div class="card linguagens" onclick="selecionarMateria('portugues', 'Linguagens')">
        <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          <line x1="9" y1="10" x2="15" y2="10"></line>
          <line x1="12" y1="7" x2="12" y2="13"></line>
        </svg>
        Linguagens
      </div>
    </div>
  </div>
  
  <!-- Tela de prova -->
  <div class="prova-container" id="provaContainer">
    <div class="prova-header">
      <h2 id="provaTitulo">Prova</h2>
      <button class="fechar-prova" onclick="fecharProva()">Fechar</button>
    </div>
    
    <div class="questao-container">
      <div class="questao" id="questaoAtual"></div>
    </div>
    
    <div class="navegacao">
      <button class="nav-button" id="btnAnterior" disabled>Anterior</button>
      <button class="nav-button" id="btnProxima">Pr√≥xima</button>
      <button class="nav-button" id="btnFinalizar" style="display: none;">Finalizar</button>
    </div>
    
    <div class="progresso" id="progressoIndicador">
      Quest√£o <span id="questaoAtualNum">1</span> de <span id="totalQuestoes">8</span>
    </div>
    
    <!-- Tela de Resultados -->
    <div class="resultado-container" id="resultadoContainer">
      <h2>Resultados</h2>
      <div class="resultado-pontuacao">
        <span id="acertosTotal">0</span>/<span id="totalQuestoesResultado">8</span>
      </div>
      <div class="resultado-detalhes" id="resultadoDetalhes">
        <!-- Preenchido dinamicamente via JavaScript -->
      </div>
      <button class="btn-finalizar" onclick="fecharProva()">Voltar ao In√≠cio</button>
      <button class="btn-tentar-novamente" onclick="tentarNovamente()">Tentar Novamente</button>
    </div>
  </div>
  
  <script src="questoes9passe.js"></script>
  
  <script>
    // Classe para gerenciar a acessibilidade de leitura de tela
    class ScreenReader {
      constructor() {
        this.synth = window.speechSynthesis;
        this.isReading = false;
        this.isPaused = false;
        this.currentUtterance = null;
        this.queue = [];
        this.currentIndex = 0;
        this.speed = 1;
        this.volume = 1;
        this.voice = null;
        
        this.initializeVoices();
        this.bindEvents();
      }
      
      initializeVoices() {
        // Aguarda as vozes carregarem
        const setVoice = () => {
          const voices = this.synth.getVoices();
          // Tenta encontrar uma voz em portugu√™s
          this.voice = voices.find(voice => 
            voice.lang.startsWith('pt') || 
            voice.name.toLowerCase().includes('portuguese')
          ) || voices[0];
        };
        
        if (this.synth.getVoices().length > 0) {
          setVoice();
        } else {
          this.synth.addEventListener('voiceschanged', setVoice);
        }
      }
      
      bindEvents() {
        const btn = document.getElementById('accessibilityBtn');
        const controls = document.getElementById('accessibilityControls');
        const speedControl = document.getElementById('speedControl');
        const volumeControl = document.getElementById('volumeControl');
        const speedValue = document.getElementById('speedValue');
        const volumeValue = document.getElementById('volumeValue');
        const pauseBtn = document.getElementById('pauseBtn');
        const stopBtn = document.getElementById('stopBtn');
        const skipBtn = document.getElementById('skipBtn');
        
        // Bot√£o principal
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          this.toggleReading();
        });
        
        // Mostrar/esconder controles
        btn.addEventListener('mouseenter', () => {
          if (this.isReading) {
            controls.classList.add('show');
          }
        });
        
        controls.addEventListener('mouseleave', () => {
          setTimeout(() => {
            if (!controls.matches(':hover')) {
              controls.classList.remove('show');
            }
          }, 300);
        });
        
        // Controles de velocidade e volume
        speedControl.addEventListener('input', (e) => {
          this.speed = parseFloat(e.target.value);
          speedValue.textContent = this.speed + 'x';
          if (this.currentUtterance) {
            this.currentUtterance.rate = this.speed;
          }
        });
        
        volumeControl.addEventListener('input', (e) => {
          this.volume = parseFloat(e.target.value);
          volumeValue.textContent = Math.round(this.volume * 100) + '%';
          if (this.currentUtterance) {
            this.currentUtterance.volume = this.volume;
          }
        });
        
        // Bot√µes de controle
        pauseBtn.addEventListener('click', () => this.togglePause());
        stopBtn.addEventListener('click', () => this.stopReading());
        skipBtn.addEventListener('click', () => this.skipCurrent());
        
        // Fechar controles ao clicar fora
        document.addEventListener('click', (e) => {
          if (!btn.contains(e.target) && !controls.contains(e.target)) {
            controls.classList.remove('show');
          }
        });
      }
      
      getReadableContent() {
        const content = [];
        
        // Conte√∫do espec√≠fico para a p√°gina de sele√ß√£o de mat√©rias do 9¬∫ ano
        content.push({ text: 'P√°gina: ' + document.title, element: null });
        content.push({ text: 'Site Quiz Connect', element: '.logo' });
        content.push({ text: 'Menu de navega√ß√£o com op√ß√µes: In√≠cio e Cadastro', element: 'nav' });
        content.push({ text: 'T√≠tulo: Escolha sua √Årea do Conhecimento para realizar a Prova', element: 'h1' });
        
        // Cards de mat√©rias
        content.push({ text: 'Card de Matem√°tica. Clique para selecionar esta mat√©ria', element: '.card.matematica' });
        content.push({ text: 'Card de Ci√™ncias da Natureza. Clique para selecionar esta mat√©ria', element: '.card.natureza' });
        content.push({ text: 'Card de Ci√™ncias Humanas. Clique para selecionar esta mat√©ria', element: '.card.humanas' });
        content.push({ text: 'Card de Linguagens. Clique para selecionar esta mat√©ria', element: '.card.linguagens' });
        
        // Se a prova estiver aberta
        const provaContainer = document.getElementById('provaContainer');
        if (provaContainer && provaContainer.style.display === 'block') {
          content.push({ text: 'Prova aberta: ' + document.getElementById('provaTitulo').textContent, element: '#provaTitulo' });
          content.push({ text: 'Quest√£o atual: ' + document.getElementById('questaoAtualNum').textContent + ' de ' + document.getElementById('totalQuestoes').textContent, element: '#progressoIndicador' });
          content.push({ text: 'Conte√∫do da quest√£o: ' + document.getElementById('questaoAtual').textContent, element: '#questaoAtual' });
          
          const btnAnterior = document.getElementById('btnAnterior');
          const btnProxima = document.getElementById('btnProxima');
          
          if (btnAnterior.disabled) {
            content.push({ text: 'Bot√£o Anterior desativado', element: '#btnAnterior' });
          } else {
            content.push({ text: 'Bot√£o Anterior para voltar √† quest√£o anterior', element: '#btnAnterior' });
          }
          
          content.push({ text: 'Bot√£o Pr√≥xima para avan√ßar para a pr√≥xima quest√£o', element: '#btnProxima' });
        }
        
        // Se os resultados estiverem vis√≠veis
        const resultadoContainer = document.getElementById('resultadoContainer');
        if (resultadoContainer && resultadoContainer.style.display === 'block') {
          content.push({ 
            text: 'Resultados: Voc√™ acertou ' + document.getElementById('acertosTotal').textContent + ' de ' + document.getElementById('totalQuestoesResultado').textContent + ' quest√µes', 
            element: '.resultado-pontuacao' 
          });
          content.push({ text: 'Detalhes dos resultados: ' + document.getElementById('resultadoDetalhes').textContent, element: '#resultadoDetalhes' });
          content.push({ text: 'Bot√£o Voltar ao In√≠cio para retornar √† sele√ß√£o de mat√©rias', element: '.btn-finalizar' });
          content.push({ text: 'Bot√£o Tentar Novamente para refazer a prova', element: '.btn-tentar-novamente' });
        }
        
        content.push({ text: 'P√°gina desenvolvida com recursos de acessibilidade', element: null });
        content.push({ text: 'Use os controles de velocidade e volume para personalizar a leitura', element: null });
        
        return content;
      }
      
      toggleReading() {
        if (this.isReading) {
          this.stopReading();
        } else {
          this.startReading();
        }
      }
      
      startReading() {
        this.queue = this.getReadableContent();
        this.currentIndex = 0;
        this.isReading = true;
        this.isPaused = false;
        
        const btn = document.getElementById('accessibilityBtn');
        const controls = document.getElementById('accessibilityControls');
        
        btn.classList.add('active');
        btn.innerHTML = 'üîä';
        btn.title = 'Leitura ativa - Clique para parar';
        controls.classList.add('show');
        
        this.readNext();
      }
      
      readNext() {
        if (this.currentIndex >= this.queue.length) {
          this.stopReading();
          return;
        }
        
        const currentItem = this.queue[this.currentIndex];
        const text = currentItem.text;
        this.currentUtterance = new SpeechSynthesisUtterance(text);
        
        // Configura√ß√µes da voz
        if (this.voice) {
          this.currentUtterance.voice = this.voice;
        }
        this.currentUtterance.rate = this.speed;
        this.currentUtterance.volume = this.volume;
        this.currentUtterance.pitch = 1;
        this.currentUtterance.lang = 'pt-BR';
        
        // Destacar elemento ANTES de come√ßar a falar
        this.highlightCurrentElement();
        
        // Eventos
        this.currentUtterance.onend = () => {
          this.currentIndex++;
          if (this.isReading && !this.isPaused) {
            setTimeout(() => this.readNext(), 500);
          }
        };
        
        this.currentUtterance.onerror = (e) => {
          console.warn('Erro na s√≠ntese de voz:', e);
          this.currentIndex++;
          if (this.isReading) {
            this.readNext();
          }
        };
        
        this.synth.speak(this.currentUtterance);
      }
      
      highlightCurrentElement() {
        // Remove highlight anterior
        document.querySelectorAll('.reading-highlight').forEach(el => {
          el.classList.remove('reading-highlight');
        });
        
        // Pega o elemento atual baseado no seletor
        const currentItem = this.queue[this.currentIndex];
        if (currentItem && currentItem.element) {
          const element = document.querySelector(currentItem.element);
          if (element) {
            element.classList.add('reading-highlight');
            
            // Rola a p√°gina para mostrar o elemento destacado
            element.scrollIntoView({ 
              behavior: 'smooth', 
              block: 'center' 
            });
          }
        }
      }
      
      togglePause() {
        const pauseBtn = document.getElementById('pauseBtn');
        const btn = document.getElementById('accessibilityBtn');
        
        if (this.isPaused) {
          this.synth.resume();
          this.isPaused = false;
          pauseBtn.innerHTML = '‚è∏Ô∏è Pausar';
          btn.classList.remove('paused');
          btn.classList.add('active');
        } else {
          this.synth.pause();
          this.isPaused = true;
          pauseBtn.innerHTML = '‚ñ∂Ô∏è Continuar';
          btn.classList.remove('active');
          btn.classList.add('paused');
        }
      }
      
      stopReading() {
        this.synth.cancel();
        this.isReading = false;
        this.isPaused = false;
        this.currentIndex = 0;
        
        const btn = document.getElementById('accessibilityBtn');
        const controls = document.getElementById('accessibilityControls');
        const pauseBtn = document.getElementById('pauseBtn');
        
        btn.classList.remove('active', 'paused');
        btn.innerHTML = 'üîä';
        btn.title = 'Ativar leitura de tela';
        controls.classList.remove('show');
        pauseBtn.innerHTML = '‚è∏Ô∏è Pausar';
        
        // Remove highlights
        document.querySelectorAll('.reading-highlight').forEach(el => {
          el.classList.remove('reading-highlight');
        });
      }
      
      skipCurrent() {
        if (this.isReading) {
          this.synth.cancel();
          this.currentIndex++;
          if (this.currentIndex < this.queue.length) {
            setTimeout(() => this.readNext(), 200);
          } else {
            this.stopReading();
          }
        }
      }
    }
    
    document.addEventListener("DOMContentLoaded", function () {
      // Inicializa o leitor de tela
      const screenReader = new ScreenReader();
    });
  </script>
</body>
</html>